@page "/register"
@using BlazorInputFile
@using System.IO

<h3>Register</h3>
<div class="col-12">
    <div class="col-8">
        <input type="text" class="form-control" placeholder="first name">
        <br />
        <input type="text" class="form-control" placeholder="last name">
        <br />
        <input type="text" class="form-control" placeholder="email address">
        <br />
        <input type="password" class="form-control" placeholder="password">
        <br />
        <img src="@ProfilePicDataUrl" style="width: 250px; height: 250px;"> <br /> <br />
        <InputFile OnChange="@OnInputFileChanged"></InputFile>
        <br />

        <button class="btn btn-primary">Sing up!</button>
    </div>
</div>
@code {
    public string ProfilePicDataUrl { get; set; }

    private async Task OnInputFileChanged(IFileListEntry[] files)
    {
        var file = files.FirstOrDefault();
        var img = await file.ToImageFileAsync("image/jpeg", 250, 250);
        MemoryStream memory = await img.ReadAllAsync();
        ProfilePicDataUrl = ToDataUrl(memory, "image/jpeg");
    }
    public string ToDataUrl(MemoryStream data, string format)
    {
        var span = new Span<byte>(data.GetBuffer()).Slice(0, (int)data.Length);
        return $"data:{format};base64,{Convert.ToBase64String(span)}";
    }

}
